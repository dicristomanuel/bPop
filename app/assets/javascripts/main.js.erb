$( document ).ready(function() {

  var fanTransferred = '',
      isDropped = false,
      notDropped = '';

      $('.circle-step-one').show();
      $('.circle-step-two').hide();

$('#6-m-posts').animateNumber({ number: $('#6-m-posts').text() }, 1500);
$('#6-m-likes').animateNumber({ number: $('#6-m-likes').text() }, 1500);
$('#6-m-comments').animateNumber({ number: $('#6-m-comments').text() }, 1500);
$('#gender-percentage-male').animateNumber({ number: $('#gender-percentage-male').text() }, 1500);
$('#gender-percentage-female').animateNumber({ number: $('#gender-percentage-female').text() }, 1500);


  $('profile-pic.small').hover(function() {
    thisName = $(this).text()
      $('fan-name').text(thisName);
  });


  function handleDragStart(e) {
    isDropped = false;
    fanTransferred = this.childNodes['1'].innerHTML;
    notDropped = this.childNodes['1'].childNodes;
    var image = this.childNodes['1'].childNodes;
    $(image).css({opacity: 0.4});
  }


  function handleDragEnd(e) {
    if (isDropped === false) {
      $(notDropped).css({opacity: 1});
    }
  }

  var pics = $('profile-pic.small');

  [].forEach.call(pics, function(pic) {
    pic.addEventListener('dragstart', handleDragStart, false);
    pic.addEventListener('dragend', handleDragEnd, false);
  });

  $('group-circle').on('dragover', function() {
    $(this).css({opacity:'0.6'});
    $(this).addClass('scaleUp');
  });

  $('group-circle').on('dragover', function(e) {
    e.preventDefault();
  });

  $('group-circle').on('drop', function(e) {
    e.preventDefault();
    $(this).css({opacity:'1'});
    $(this).removeClass('scaleUp');
    $('container-group-fans').append('<profile-pic class="small inside-group">' + fanTransferred + '</profile-pic>');
    isDropped = true;
      $('.circle-step-one').hide();
      $('.circle-step-two').fadeIn();
    // api call to display the posts
  });

  $('container-group-fans').on('click', '.inside-group', function () {
    var id = this.firstChild.attributes['0'].nodeValue;
    image = 'img#' + id;
    $(image).css({opacity: 1});
    this.remove();
    if ($('#main-circle-fans')['0'].childElementCount > 0) {
      $('.circle-step-one').hide();
      $('.circle-step-two').fadeIn();
    } else {
      $('.circle-step-two').hide();
      $('.circle-step-one').fadeIn();
    }
  });





});
